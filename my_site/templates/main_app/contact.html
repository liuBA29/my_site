<!-- templates/main_app/contacts.html -->
{% extends 'base.html' %}
{% load i18n %}
{% block title %}контакты{% endblock %}

{% block content %}
  {% if messages %}
    <div class="page-messages">
      {% for message in messages %}
        {% if 'success' in message.tags %}
          <div class="page-message success">
            {{ message }}
          </div>
        {% endif %}
      {% endfor %}
    </div>
  {% endif %}

  <h2>{% trans "My contacts" %}</h2>

  <p class="section-description">
    <span>Email: luba.sentino@gmail.com</span><br>
    <span>Telegram: @liubakovaleva</span><br>
    <a href="#" id="open-chat" class="soft-item-link"><span>Чат-online</span></a><br>
  </p>

  <!-- Модальное окно -->
  <div id="chatModal" class="modal" style="display:none;">
    <div class="modal-content" style="background:white; padding: 20px; border-radius: 10px; max-width: 800px; margin: auto;">
      <span class="close" style="float:right; font-size:24px; cursor:pointer;">&times;</span>
      <div id="chatContent">Загрузка...</div>
    </div>
  </div>

  <style>
.page-messages {
    margin: 20px 0;
    text-align: center;
}

.page-message {
    padding: 10px 20px;
    border-radius: 10px;
    margin: 10px auto;
    max-width: 600px;
    font-weight: bold;
    font-size: 16px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.page-message.success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.page-message.error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

.page-message.warning {
    background-color: #fff3cd;
    color: #856404;
    border: 1px solid #ffeeba;
}

.page-message.info {
    background-color: #d1ecf1;
    color: #0c5460;
    border: 1px solid #bee5eb;
}


    .modal {
      position: fixed;
      z-index: 9999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 800px;
      position: relative;
      top: 1cm;
      margin: auto;
    }

    .modal-open {
      overflow: hidden;
    }



  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const modal = document.getElementById('chatModal');
      const openBtn = document.getElementById('open-chat');
      const closeBtn = modal.querySelector('.close');
      const chatContent = document.getElementById('chatContent');

      openBtn.addEventListener('click', function (e) {
        e.preventDefault();
        modal.style.display = 'block';
        document.body.classList.add('modal-open');

        fetch("{% url 'chat:lobby' %}?partial=1")
          .then(response => response.text())
          .then(html => {
            chatContent.innerHTML = html;
            const scriptTags = chatContent.querySelectorAll("script");
            scriptTags.forEach(oldScript => {
              const newScript = document.createElement("script");
              newScript.text = oldScript.text;
              document.body.appendChild(newScript);
            });
          });
      });

      closeBtn.addEventListener('click', function () {
        modal.style.display = 'none';
        document.body.classList.remove('modal-open');
        chatContent.innerHTML = '';
      });

      window.addEventListener('click', function (e) {
        if (e.target === modal) {
          modal.style.display = 'none';
          document.body.classList.remove('modal-open');
          chatContent.innerHTML = '';
        }
      });
    });
  </script>
{% endblock %}
